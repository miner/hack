(ns advent25.day4
  (:require [clojure.string :as str]))



(def example4
"..@@.@@@@.
@@@.@.@.@@
@@@@@.@.@@
@.@@@@..@.
@@.@@@@.@@
.@@@@@@@.@
.@.@.@.@@@
@.@@@.@@@@
.@@@@@@@@.
@.@.@@@.@." )


(defn chb [ch]
  (case ch
    \. false
    \@ true))

(defn parse-input [s]
  (vec (str/split-lines s)))

(defn roll-at? [grid row col]
  (= \@ (nth (nth grid row nil) col nil)))

(defn count-neighbors [grid r c]
  (let [up (dec r)
        down (inc r)
        left (dec c)
        right (inc c)]
    (reduce (fn [sum [x y]] (if (roll-at? grid x y) (inc sum) sum))
            0
            [[up left] [up c] [up right] [r left] [r right] [down left] [down c] [down right]])))

(defn day4 [input]
  (let [grid (parse-input input)]
    (reduce + 0 
            (for [r (range (count grid))
                  c (range (count (nth grid 0)))
                  :when (and (roll-at? grid r c) (< (count-neighbors grid r c) 4))]
              1))))
        

;;; part 2, marked eligible rolls, remove them, and re-calc, keep removing until you can't take any
;;; more away.  Calc total number removed.

;;; new idea: just keep a set of coords for roll-set.  Count dynamically as you only need to
;;; return a list of removables, not maintain counts.

(defn parse-input-roll-set [s]
  (let [linev (vec (str/split-lines s))
        row-cnt (count linev)
        col-cnt (count (linev 0))]
    (into #{}
          (for [r (range row-cnt)
                c (range col-cnt)
                :when (= (nth (nth linev r) c) \@)]
            [r c]))))

(defn nei-count [roll-set [r c]]
  (let [up (dec r)
        down (inc r)
        left (dec c)
        right (inc c)]
    (reduce (fn [sum coord] (if (roll-set coord) (inc sum) sum))
            0
            [[up left] [up c] [up right] [r left] [r right]
             [down left] [down c] [down right]])))

(defn removables [roll-set]
  (reduce (fn [res rc]
            (if (< (nei-count roll-set rc) 4)
              (conj res rc)
              res))
          []
          roll-set))

(defn remove-coords [roll-set coords]
  (reduce disj roll-set coords))

(defn day4-2 [input]
  (let [init (parse-input-roll-set input)
        final (loop [roll-set (parse-input-roll-set input)]
                (let [cnt (count roll-set)
                      rs2 (remove-coords roll-set (removables roll-set))
                      cnt2 (count rs2)]
                  (if (= cnt cnt2)
                    rs2
                    (recur rs2))))]
    (- (count init) (count final))))



;;; grid is 140 x 140  too big for convenient 64 bits
;;; but could work with int-map, didn't try

(def input4
"...@.@@@@@..@.@.@@@@@..@@@@.@@@@@@@..@.@.@@@@@.@@@..@..@@..@@@@@@.@.@.@@@@@@.@@.@@@@..@.....@.@.@....@@.@@@.@@@.@@@@.@@@.@.@.@@@@.@@@@.@@@@.
.@.@.@.@@@@@@.@@@..@@@@@@@@@@.....@@@@@@@@@@..@@@@@@..@@@...@.@.@@.@@.@@@@@@.@.@@@@.@@@@.@@@@@.@@@@@.@@@@@.@.@.@@@.@.@.@@@@.@@.@@@@@@@@@@@@@
@@@@@..@.@@@@.@.@@.@@@.@@@@..@@.@..@.@@@.@@.@.@@.@@@@@@..@@@@@..@@@@.@.@@@@.@@..@@@@....@@@....@.@@...@@@.@.@@@.@.@.@@@@@@@@@@@@@@.@@..@.@.@
@@@.@@@@@..@@@@@@@@.@@@.@...@..@.@@......@@.@@.@@.@@@@@@@@...@@@@.@@@@@@@@@@@.@@@.@.@@@@@.@@.@@@@@@@@@.@@@@.@@@.@..@.@@.@@@@...@.@..@@@...@.
@...@@@.@@.@@@@.@.@@....@@.@@@.@..@..@@.@@@@.@..@@@@@@...@@.@@@@@@@.@.@.@@@....@@.@@@@@@.@@@.@@@@@@@@@@.@@@..@@@.@@..@@@@@@@.@@@..@...@@@@.@
.@@...@@.@..@@@@..@@.@@@@@@..@..@@.@@@@..@@@@@@@@@@@@@@@@..@@@@@@.@@@@..@@@.@@.@@@@@@.@...@...@@@@.@.@@@.@..@@@.@@.@@@.@.@@@@@@.@@@.@@@@@.@@
.@@@@...@.@@.@@@@.@@@@@.@@@@..@@@@@...@@@@@.@@@@@@..@@@@@...@@@@@@.@...@@@@@@.....@@@@@@@@@@@@@@@.@@@@.@@@@@..@@@.@@@.@@@@@@@.@..@@@@@@@.@@@
@@@@@@@..@@.@...@.@@@@@.@@.@@...@@@@...@..@.@@@@@@.@.@@@.@@.@@@.@.@@@..@.@@@@@@......@@@@@@.@@...@@.@.@@@@@@@.@@.@@..@@@.@.@@@@@@@@@@..@.@@.
@@@@@@@@..@.@@..@.@..@.@...@.@..@@@@.@..@.@.@@.@.@....@@@@@@.@@@@@@@@@.@@@@@@...@@@@@@@.@.@.@@@@@@@.@.@@.@.......@@@@@@..@@..@@@@@..@...@@..
@@.@@@@@@.@.@@..@@@@.@@.@..@...@@..@....@@@..@@@.@..@.@@@@@@@@@...@@@@@.@@@@..@@@@.@@@@@@@@@@@@.@@@@@.@@.@@@@.@@@@@.@@@@@.@@@.@@@@.@@..@@..@
...@@.@@.@@@@.....@@.@.@@..@@@.@@@.@..@@..@.@@.@@@.@@..@@.@@@..@@@.@@.@@@@@@.@@@.@@@@@..@..@@.@.@@.@..@@...@@@@@.@.@@..@@.@...@@@@.@@.@@@@@@
.@@@@@@@@@@.@@.@@@@...@@@@@..@..@@.@@@.@@..@..@@@@.@@..@@@@@@.@@@@@@@@.@..@@@@@@@..@@@@.@@@@@.@....@@.@@@@@@.@.@@@.@@.@.@..@@@@@.....@@.@@.@
@@@@@@@@.@@@@@@@@@.@@.@@@...@@@@...@@@@@@.@@@.@@@@@.@@.@.@.@@@@.@@@@..@@@@@@@.@@@@..@.@.@.@@@@@@@@@@@@@.@@@@@@@.@@.@.@.@@@@@...@@@.@.@@@@@.@
@@.@@@@@@@@@...@@@@@...@@@.@@.@@@@.@@@.@...@..@.@@@.@.@@@@..@@.@@@@.@@...@@@.@..@@.@@@@@.@@@.@@..@.@@.@...@@@....@@@@@......@.@@...@.@@@...@
@..@@.@@.@.@@@.@..@@@@@@@@@@.@.@.@@@@@@@.@@@.@@@.@@.@@@@.@.@..@.@.@@@.@@@@.@.@.@.@....@.@@.@...@.@@@@@@@@..@.@.@@@@.@@@.@@..@@@@@@..@@...@@.
@.@@@@@..@.@@..@@@@.@@@@.@@...@..@@.@.@.@@@@@@@..@.@@@@.@@@@@@@@..@@.@@@...@@@@@..@@@.@@@.@@@@@@@@.@.@.@@@@.@.@@.@.@@.@@@@@@@@.@@@@@@@@@@.@@
@.@.@@@...@@@@@@....@@.@@@@@..@@.@@..@@.@@.@@.@.@@@.@@@@...@..@@..@@.@@@...@@...@@.@@.@@@@@.@@@@@..@@.@@@@.@@.@.@@@@@@@@.@@@@@@.@@@@@@@.@..@
@@.@@@@.@@.@.@.@@@@.@@.@.@@@@.@.@.@@@...@..@@.@@@@@@@.@@@@@@..@@@@.@@@..@@@@@@@.@.@@@..@@@@@@.@..@..@@..@@@@@@@.@@@@..@.@@@@@@.@@.@@@@@@@@@.
.@.@@@.@@.@@@@.@.@.@@@@@.@@.@@@@..@....@@..@@@.@.@@@.@@@@@@@@.@@@...@@@.@.@..@@@@@.@@@.@@..@.@@....@@@...@.@@@@@@@.@@.@@@.@.@@@@@@@@@@@@.@@@
@@@.@@.@@..@.@@.@@.@@@.@@..@..@@..@@@@@@@@@@@@@..@@@@...@@@.@@@.@@.@@..@.....@@@.@..@@@@@@@@@.@@.@@@@@.@@@@@@@@@..@@.@.@@@@@@.@@.@@@@.@@.@@.
.@@@.@@..@@@@@.@@@@.@@@@@@@@...@@@@@.@..@@@@@@@..@..@@@@.@@.@@@.@@@..@.@..@.@.@.@@.@@..@.@@@.....@@.@@@@.@.....@@@.@@@.@@@..@@@.@@...@@@@..@
@@@...@@@@@@@.@@....@@@@@@@@.@@..@@@.@@@@.@@.@.@@@.@@@@@@@@@@@.@@..@@@@.@@...@......@....@@@..@@@@..@.@@@@.@@....@@.@@.@.@@@@@.@.@.@@.@.@.@@
@@...@@@@@@.@.@@@.@@.@@.@@@@@@.@@..@@@.@@.@.@....@@.@..@@@@@@@@.@@.@.@...@...@@@..@.@@@@@@.@..@.@@@.@@@@@@@@@@.@.@.@.@@.@@@@@@.@@@@@@@@@..@@
@..@@@..@..@@@.@.@@@..@@@...@..@..@.@@..@@@.@@@.@@@@..@.@@@@@.@@@@.@@..@@@@@@.@@@@@.@@.@..@@@@@@.@@.@@@..@@@@@@..@@@.@@@@@.@@@@..@.@..@.@..@
...@@..@@.@@.@@@@@.@@@.@@.@.@@@@.@@@@@@@.@@..@@.@@..@@@@.@@..@.@@@@@..@@.@.@@@@@@@@@@@.@.@..@@@@@@..@@@.@.@@@@.....@.@@..@@.@@@.@.@.@...@@@.
@@@..@.@@....@@@@@.@@@@@.@@@@.@@@.@@@@.@..@@@@@@..@..@@@@@@@@.@@@@.@@@@@@.@@@...@.@@.@@@@.@@.@@..@.....@@@...@.@.@..@@.@@@@.@@@@@@..@@.@.@@@
@@@@.@@.@@@..@.@@@@.@@.@@@@@...@@.@.@@@@..@@@@@@@.@@...@@@..@@@@@@@.@@.@..@@@@.@.@@@@@.@.@@@..@@@..@@.@.@...@@@..@.@@@.@@.@@@@@@....@@....@@
@@@.@.@@@@@@@@@@...@@.@.@@.@@.@.@@.@..@..@..@@.@@@@@@@@@@@.@@..@.@@@@@..@.@@@....@..@@.@@.@@.@.@@@@@.@@@@@@..@@@.@@@@@@@@.@.@@.@.@.@@.@@@.@@
@@@.@.@..@@.@.@@@...@@@.@@@@..@@@@@@@@@@@@@@@@.@@.@@@@@.@.@@...@@...@@@@....@@@@@@@....@@@@@@@@@@@@@@.@@@@@@.@...@@..@.@@@@.@@@@@..@@..@.@..
@@..@@@@@@..@@@@.@....@@@@@@@..@..@.....@..@@@.@....@..@@@@..@@..@.@@..@.@.@@.@@@..@@@@...@@@..@@@.@...@@..@...@@.@.@.@..@@@.@.@@@@@..@@.@..
@@@..@.@@@@@.@@.@@@.@@@@.@.@.@@@@@..@@@..@..@@.@@.@@@@@@@@.@@@@@.@@@.@@.@@...@@@@.@@.@@..@..@..@@@@@@@@.@@@@@@@.@..@....@@.@..@..@@@@@.@.@@@
@.@@@.@@@..@.@....@.@@.@.@@@@...@.@@..@@@@@@...@@.@.@@@@@.@...@@@@@@@..@.@..@@@@@@.@@@@@@@.@.@.@@@@.@@@@@@..@@.@@@.@.@@@@@@@.@@@@@.@@.@@@...
@.@@@@@..@@@@@@@@@@.@.@@@..@@@@@@@..@@..@@@@@@.@..@@@@@@@@.@@@@..@.@@@.@@@@@..@.@@@@@..@@..@@@@.@@@@..@@@@@@.@@@@@@@@@.@@.@@@.@..@@....@@.@.
.@...@.@@@.@@..@@.@@.@@@@@.@@@..@@@....@..@@.@@..@@@..@@.@.@..@....@.@.@....@@@@.@@@@.@@..@@.@@.@.@@.@.@@..@@@.@@.@.@@@.@@@@..@@...@..@@.@@.
@@@@@@..@@@@.@@@@@@.@...@..@.@@@.@@@@.@@@@..@@..@@@..@@@@@@@@...@.@....@@@@@@.@@@..@..@@@@.@.@@@@@@@.@@@....@@@.@.@.@.@...@@@@@@.@@@@@@.@@@@
.@@@@@....@@.@@@@@.@@@.....@@.@@@.@@@@@...@@.@@..@..@.@.@@@@....@@@@@@@@..@@.@.@@@..@@@..@@@@@@@@.@@.@@..@@@..@...@.@.@@@@..@@@....@@@@@...@
...@@@.@@@.@@@@.@.@@@@@@@.@.@@@..@@@@@@@@@.@.@@.@@@@.@@@@@@@@@@@@@@@@@@@@@.@@@@.@@...@....@@.@@@..@@..@....@.@@@..@@@...@@@.@@.@@@@@@@@.....
@@@.@@..@.@..@.@.@@@@@.@@@@.@@.@..@@@....@.@@@@@.@..@.@...@@@@@@.@.@.....@.@@.@@@.@@@@@@@@@@@.@@@@@@..@@@@@.@.@@@..@..@...@@@@@@@@@@@@.@@@@@
@@.@@..@@@@@@@..@.@@@@@..@@@@@@.@@...@@@..@.@@@@@@.@.....@@.@@@.@@@@.@@@@..@.@@..@@.@.@.@@@@@.@@@@@@@@.@@@@@.@.@..@@.@@@@@@@.@@..@..@@..@.@.
.@@.@.@@@@@.@.@@..@@@.@@@@@@@..@@@.@@.@@@....@@@@..@.@@@.@..@.@.@@@.@.@@...@.@@@@@@.@..@.@.@@.@@@@@@@@@.@@.@.@.@.@@@@@@@@.@@@.@@...@@.@@@.@@
@@....@@@.@.@@@.@.@.@@@....@@@.@.@@...@@@..@@@@.@@@@@....@@@.@.@@@@@@.@.@.@...@.@@@@@.@.@@.@..@@@@@@@@.@....@@@..@@@@.@@...@.@...@@@@@.@.@.@
@..@@.@.@...@.@.@..@@@@@.@......@.@@@@....@@.@..@@@.@@@@@.@.@.@@@@.@@@@@@@.@@@@..@@@...@.@@@@@...@@@@@@@@@.@@.@.@@@.@..@@@@@@.@.....@@@.@@@@
.@@@@@..@@@@@@@.@@.@@@@.@@@@@.@.@.@@..@@@@.@@.@.@@.@@@@@@.@@@@@@@..@@..@@@@..@@@@..@@.@@@.@@@@.@.@@@..@..@@.@.@.@@@...@..@@.@.@@@..@@@.@@@@@
...@@.@@@@@@@@...@@...@@@@@@@@@@@@@@.@@.@@@@@@@@@..@@@.@@@@..@@@...@@..@@@@..@.@@@.@@.@@@.@.@@@@..@..@...@@@@.@@@@.@.@@@@..@@@@@@.@@@@@@.@.@
.@@@@...@@.@@.@.@@@@@@@@@@@.@@@@...@@@@.@@@@@..@@@.@@..@@..@@..@@...@@@@@..@@@...@..@@.@.@@.@@@@@@.@@@@@@@..@@.@..@@@..@.@@..@@@@@@...@@@..@
@.@.@@..@@@.@@@@.@@.@@@@@.@..@@.@@@@@@@@..@@@..@@.@@@.@@.@@.@.@@@@@.@@...@@.@.@.@.@@@.@.@@@@@.@.@@@@@..@..@@@@.@..@@@@@...@@@@@@@@@@@...@@@.
.@@.@...@.@..@.@@@@.@@.@..@@.@@..@@.@@.@@.@@@@@..@..@.@@@@@@@.@@@..@@@.@@@@@.@@@..@@.@@@@@@@..@@@@.@@@@@@@.@.@.@@@@@@@@.@@.@@@@.@@@..@@@..@@
.@@@@....@@.@@@.@....@@@@@@@.@@@@.@@@@@...@@@.@.@.@.@@@.@.@.@@.@@@.@@@@@.@..@@@@@@.@@..@..@.@.@@@@@..@...@...@.@@@.@@@@@@@.@.@@@@...@.@@@@@@
.@@@@@.@@@@@..@@.@.....@.@@.@.....@@@@@@.@@..@@@@.@@....@@@@@...@@.@@...@@@.@@.@@.@@@.@@@@.@.@@@@@@@.@.@@.@..@.@@@@@@.@@.@@..@@@@.@@...@@.@@
.@@.@.@@.@@@@@@@...@@..@.@@@.@@@@@.@@@@@.@@@@@@@@..@@@@@@@...@@.@@@@.@.@@.@.@.@@@..@@@@@.....@@@@@.@@@.@@@.@@.@...@@..@@.@@@@@@@@.@@@....@@.
@..@..@@@@.@....@@@.@..@.@@@@@..@@@@.@@@@.@....@@@..@@@@.@.@.@@..@@@@@@@@.@@@.@@..@.@.@@..@....@@..@.@@.@@.@..@@.@.@@...@.@@@@.@@@@@@@@....@
.@@@@@@@@@.@@@..@.@@@@@@@@@@...@@@@@@@@@@@@.@@@.@@@@@@@@..@@@@..@@.@.@@@.@@@@@.@@@@.@.@@.@@.@.@..@@.@.@@.@.@.@@..@..@@..@.@@@@.@@.@@@.@@@@..
@@@@.@@@@@@.@@.@@@@@.@@@.@@@@@@..@@@.@@@@@@@@@@@@@@..@..@@.@..@@.@@@....@@@@.@..@@@@@@.@...@.@@@.@@@....@@.@@@@@.@@@.@.@@@.@..@@@@@..@@@.@@@
@@.@@.@@@@@@...@@.@@@@@.@@.@@...@.@.@@@@@....@@.@@@@..@@@@@@.@@@@.@@@.@..@@.@...@.@.@@.@.@.@.@@@@.@@@.@@@@.@.@@@@..@@@@@@@...@.@@@.@.@@.@@@@
.@@@@.@@@.@@@@.@@..@..@.@..@@@.@..@..@@.@.@..@.@@@...@.@@.@.@@.@@@.@@@@@..@.@@@.@.@@@@@...@@@@.@.@@@.@.@@@@@@@@@@..@@@...@@.@.@@@@.@.@@....@
@@@.@..@@..@@@@...@@@@@@@.@@@@@.....@.@@@..@.@...@@.@@.@@@@@..@.@@@@.@@@@@@@@@..@..@@@@@@.@@@@@@.@.@.@..@@@@@@...@@@@@...@...@@@@@@.@@@@.@@@
..@...@@@@@@@.@@.@@@.@..@@@@@.@@@@@@.@@@@@..@@..@@@.@@@@@.....@@.@..@@@...@@@@@@@.@.@.@@.@@@@@..@.@@@@.@@@@@...@.@.@@@@@@@.@@@..@@@.@@@@@.@@
.@.@@@.@@.@@@..@....@@@...@@@@@@@..@@.@@@.@@@.@@@@@@..@@.@@...@@@@.@@@@@@@.@@@@..@.@@@@.@..@.@......@@.@.@@@@@@@@.@@@@@@@..@@..@..@@@@.@@@@.
@@..@...@.@@@.@.....@.@.@@.@@.@@..@@.@....@@.@@@..@@@.@.@.@@..@@..@@...@.@..@@..@..@@@@@@@@@@.@@@@.@.@@@.@@..@@@@@@@@@@@@@@@@@.@.@....@..@@.
.@@@.@@@@..@@@.@@@@@.@@.@@@@.@@..@.@@@@@@@@@.@@@@..@@@.@..@@@@..@....@@.@@@..@.@@.@@@@.@.@@@.@@@.@@@..@.@@..@..@.@@@@@.@.@...@@@@..@.@@.@.@@
@...@@@@@.@@@@@@@.@@@@@@.@..@@.@..@.@@@@.@@.@@.@.@@@@@@.@..@.@@.@@@.@@@@@...@..@@@.@@..@.@@@@@@..@@@@.@@@.@@..@.@..@@@@.@@@@...@@@@@@@@@@..@
..@.@@@.@.@.@@@@...@.@@@.@..@.@@@@.@@@.@@..@@.@...@@@@@.@@@.@@@...@@.@.@@..@@@.@@.....@@@.@@@.@@@@.@@.@..@..@@..@@.@@@...@.@@@@@@@@.@@@@.@.@
.@@@@.@@@@.@.@@@.@@..@.@@@.@@@.@@@@@...@@@.@.@@@...@@@...@@@@@.@@..@.@@@@.@@@@@@@@@.@@.@@.@.@.@@@@.@@.@@.@.@.@...@@@@@.@@@..@..@@@@@.@@.@@@@
@@@@@@@@@....@@@@@.@@@@@@.@@@.@@@.@@@..@@@.@@@.@.@@.@@@.@....@...@@@@@..@@@@@.@.@.@@.@..@@.@@..@@.@@@..@@..@@@@@@.@@..@.@@.@@@@@@@.@@..@@@.@
@@@@@@@@@@@@@@.@@@.@@@@@@@@@.@.@@@@.@.@.@@@@@@.@@@..@.@@@.@.@@.@@@@..@@@@...@@.@.@@@@..@.@.@@.@@@@@@.@@@.@.@.@...@....@@....@@..@@..@..@....
.....@@@.@@..@.@@@@@@.@@@@.@@@.@@@@..@@@@@@.@@.@@@@.@@@@@.@@@@@@@.@@@@@@....@@@@.@@@.@@.@.@.@@@@@@@@@@@@@.@..@.@.@@@@@.@@@..@@@.@.@.@@@@@.@@
@.@@@.@.....@.@@@@@.@.@@@@.@@..@@.@@.@@..@.@@@@@@@@@@.@.@..@.@.@@@..@.@@@@@......@.@@@......@@@.@@@..@@..@@@.@@@@..@@..@..@.@@@..@@@@@@..@@@
@.@.@@@@.@..@@@.@.....@...@@@.@@@.@@.@@@@.@@@@@@.@@..@@....@.@@@@@.@@@.@@@@..@...@@@.@@.@.@.@@.@@@...@.@@@....@@@@@@.@@@.@@.@.@@@.@@.@....@@
.@@@@@@@@@..@.@@@.@@@@.@@@@...@@.@@@.@.@@@.@@..@@@@.@@@@@@@@.@@@.@@@.@@.@@.@.@..@@@@@@@@@@....@@.@@@@.@@@....@@@..@.@@@@.@@@.@@..@.@@@.@@.@@
@.@@@..@..@@@@.@@@@@@...@...@.@@@@@.@@@...@.@@.@@.@@@.@@.@.@@@@@@@@@@@.@.@@.@....@@.@@@@.@@@@.@.@.@..@@@@@@@@@@.@....@......@@@...@@@@@@@@@@
.@@.@@..@.@....@...@.@@.@.@.@@@@..@.@@..@@.@@.@@@.@@@..@@...@..@@.@@.@..@..@@.@.@@@.@@@@..@@@.@@@@@@@..@@.@.@.@@@@@@@@.@@@@@.@@@@.@.@@.@.@..
.@.@@@.@@@@@.@@@..@@.@@@@@.@@@..@@@@..@@.@.@.@@@@@@@@.@@@@..@@..@@.@..@....@@@@.@@@@@.@@.@@@.....@..@..@.@@.@.@.@@@@@@.@.@@.@@@@@@@.@@.@.@@.
..@..@@@.@..@@@@@....@.@@@@@@.@.@.@@...@@.@..@.@@.@@@@@.@.@@@@.@@....@@@@.@@@.@..@.@@@.@.@...@@..@@@@.@.@@@@.....@@@@.@@@@@@@@.@@.@@@.@..@.@
@@@@@@@@..@...@@.@@.@.@@@@@@@@@@@@.@@@.@@@.@...@@.@@.@...@@@.@@@...@@.@@@.@@....@@@@@...@@@@@@.@@@.@.@.@@.@@@@@.@@@@@@.@@@..@@@.@.@@.@.@.@@@
.@@.@.@@...@@.@@@@@.@@.@..@@@@@@....@@.@@@@.@@@@.@@.@@@@@.@@@@@@.@.@@@@@.@.@@...@@.@.@..@.@..@.@@.@.@@.@@..@@.@@@@@@..@.@.@.@@...@.@@@@.@@@@
@.@@.@@.@@@.@@@@.@@.@@.@@.@@@@.@@@.@@@.@@@@@@@@@@@@@.@.@@@.@@.@@@@..@.@.@@@@..@@@@@@@@@@@@.@.@@@@@@@@@...@@@@@@.@@@@@@@.@@@@@...@@@..@@@@@@@
..@@..@@@.@@@@@.@@@@@@.@@@.@@.@.@@..@@.@.@@.@.@.@@@..@@@@.@@@@@@@@..@@@@@.@@@...@@@@.@@.@@@@@@.@@@..@.@@.@@@@.@.@@.@@@@@.@@@@@@@@@@@@.@.@@@.
@@@.@.@@@@..@@@@@@...@.@@@@.@.@@@@@@@@.@@..@@..@@.@@@.@@@.@.@@@@@@..@..@@@@.@@@@@@@@@@@@.@.@@@@.@@.@@@@@.......@@@.@@@@@....@@@@@...@@@@@@@.
@@@@@..@@@..@@@.@.@@@@.@@.@@@.@.@@..@@@.@..@@@.@.@@@@@@@.@@@.@@@@.@@@@@@@.@@@@...@@@@@@.@.@...@@@@@@..@...@@@.@.@@@@@.@@..@.@@@@@@@.@.@.@.@@
@..@@.@@.....@@.@@.@@@@..@@@@.@.@@@@..@@@.@.@@.@..@.@@..@..@@..@.@@@.@@.@.@@@@@@.@@@.@@@@@@@@.@@..@@@@.@@..@..@.@.@....@@@@.@@@..@.@@.@@@@@@
@@@..@.@@@@.@@@@..@@.@@..@.@..@.@.@@.@@@.@@@@@..@@.@@...@.@@@@...@...@.@@...@@@..@@.@.@..@@.@.@@@@.@@@@@@.@@.@@@@@@.@@@@@@@@.@@.@.@@@@@@@.@@
.@@.@@..@@@.@@@@....@.@@@@@@@@@@@@@..@@.@@.@..@@@@.@@@@@..@@.@.@@@@@@@.@@.@@@...@@.@@@@@@@.@@.@..@.@@@.@@.@@@@@@@@@.@@@.@@..@@.@@@@@@.@@....
.@@..@.@@.@@..@..@@..@@@@.@@@@@.@@..@@.@@.@@@@.@...@..@@@@@.@..@@..@.@@@@@@@@@@@.@@..@@@@@@.@@@.@@...@@@@@@.@@@@@@@@@.@.@@@@@....@.@@@@@.@.@
@.@@.@@....@@@@@@.@.@@..@@@@.@@@@@@@.@..@@.........@@.@@@.@@@@.@@@@.@@.@.@@.@@.@.....@@.@@@@..@@@.@..@.@@@@@@@..@.@@....@@@@.@@@@.@.@.@@..@@
@..@.@@.@@@@.@@@@@@..@..@@@@@@@@..@@@@@@..@.@@.@.@.@@.@.@@@.@.@@.@@..@@...@.@@@@@@@@@@@@.@@@@@@.@@..@@..@@.@@@@@.@..@@@@.@@@@@@.@@@..@@@.@@.
..@.@.@..@@@@@.@@@.@@@@@@..@@@@@@@...@@@@@@.@@@@.@.@@@@@@.@@@.@.@@@@@@.@@@.@.@@@@@@.@..@@@@@@@.@@@@@@@@@@@@@@.@@@..@.@@.@@@@@.@@@@@.@@@@.@@.
.@@.@.@.@@@@@@.@..@@.@...@.....@.@@@@@@@..@@@...@@@@..@@.@.@@@@@@@..@@@.@@@.@@...@.@.@..@@@..@@@.@..@@..@.@@.@@..@.@.@..@@..@@@@.@@@@@.@@.@@
@.@@@@@....@@..@@@@@@.@@@@@@@@@@.@@@@..@.....@@@@@@@@@.@@@..@.@.@@@...@@@@..@@@@@@@@.@@.@@@@@..@@.@@.@@@.@@@@@@@@@.@@@.@.@@@@.@..@.@@..@@.@.
@@@@@@@@@..@@.@@..@@@.@.@@@@.@..@.@@@@.@@@..@@.@@.@@...@..@.@@.@@....@@@@@@..@@@@@@@.@..@@..@@@.@@@@@.@...@@@.@@..@@.@.@.@@@...@.@@@.@@@...@
@@@..@@@@@@@..@@@@..@@@.@@@.@.@@@...@.@..@@@@@@@@.@.@@.@..@.@@.@@@@@.@@....@@...@@@@..@@.@..@@@@.@@..@@.@@@.@@@@@@.@@@@..@..@@@@@@@@@.@@@...
@.....@@@@@@..@.@@.@..@@.@@.@.@@@@...@@@@.@@@@@@@@@.@@@@.@@@@@..@@@@@.@@.@.@@@.@@.@..@.@@@@@@@@@@.@@@@@@@@@.@.@@@.@@..@.@..@@@@@@@@.@@.@@@.@
@@@@@@@@.@.@.....@@@.@@..@@@@@@@.@@@@@@@@@@.@@@.@..@@@@@@@@@@..@@.@@@@.@@@.@@@@...@@.@@.@@.@@@@@@@@@@@@@@@.@@.@@.@@.@@@@..@@@.@....@@@.@.@..
@..@@@@.@@@@@@@.@..@@@@@@@@.@@.@...@@..@@@@@.@@@.@..@@@.@@@.@..@@@@..@@@.@@@@@@.@..@...@@@@...@@@.@@@@@.@@@@.@.....@@@@@..@.@@@.@.@.@@@@.@@.
@@@@@.@...@..@@@@.@@@.@@@@@@@@.@@@..@@....@.@.@@.@.@@@@@@......@.@@@.@.@@@@.@...@@@@@.@@@@...@@@@@@@.@@.@@@@@@.@...@@@@.@@@@@@.@@@@@@@.@.@.@
@@@@@@.@.@@.@@@..@..@@@@@@@@@..@@@.@@@@.@@.@@@@...@@@.@.@..@.@.@@.@@@@..@@@@@@..@.@.@@.@@...@.@@@@.@.@@@.@@@@@@@@@.@.@.@.@.@.@@.@..@@@@@@@@.
.@@.@.@.@...@..@@@@@.@@..@@@@@.@@@@.@@.@@@@.@@..@..@@@@@..@..@@@.@@.@..@@.@@..@@@.@@@@@@.@@...@.@@.@@@.@@..@.@@@@@@..@.@@@@@@@.@.@.@.@@@@@@@
@@.@@@..@@@.@.@@.@@@@.@@@.@@.@@.@@..@@@@@@@@.@@@.@.@.@.@..@@@@@@...@@@.@.@@@.@.@@@.@..@@@..@.@@@.@@@@@.@@@@...@@@@@@@@@@@..@@.@..@@.@@...@@.
..@@@@@@@@@.@@.@@..@.@@.@@@@.@@.@@@@@@..@@@...@....@@.@@..@.@@...@@@..@@.@@@.@...@@..@@@@.@@@@.@@@@@..@.@@...@@.@@..@..@@@@@@@@..@@@@@@@@@@@
@@.@...@@@@@@@@...@.@@.@@@@..@.@@@..@@.@@@@@.@...@@@.@@@.@@@@.@@.@@@@.@@@@@.@@.@@..@@.@@@@@@@..@@...@@.@@@@@@@.@@@.@.@@@.@..@@@@@@@@@@...@@.
.@.@@@..@@@@@@.@@@..@@@@@..@..@@@@...@@.@.@..@@@@...@.@@@@.@@@@@..@@.@@@@.@.@..@..@@@...@.@@@.@@.@.@@@@@@..@..@.@.@@.@@@@@@@.@@@..@.@@@@@@@.
@.@@.@@.......@@@.@..@@@@@..@@@@...@@@@@@.@@@@@@@.@@@@@@....@@@@@@@@@.@@@@@.@@..@@@@@.@@@@@.@.@@@@...@@@@@.@@.@.@.@.....@@.@@@.@...@@....@@.
@@@@.@@@..@@..@@@....@.@@@@@..@@@@@@@.@.@@.....@.@.@@@.@.@.@@@@.@@@@@.@.@.@.@.@@..@@@@.@@@@@@@@.@@@...@..@@.@.@@@@@@@..@@.@.@@@@.@.@@@.@...@
@.@@.@@@@@@@@.@@@..@@@..@.@@@@@@@@@@@@..@.@@@.@@@.@@.@..@.@@..@..@@@@@@@@....@@@..@@@.@@@....@.@@@.@@.@@@@@...@@@@.@@.@@@..@@.@@@.@@.@.@..@.
..@.@@.@@@@@@.@@..@@.@..@@.@@.@@.@.@.....@..@@@...@@@@@@@@@..@.@.@@@@.@...@@@...@@@@....@@@..@.@.@.@@@..@@..@.@@@@@@@..@@@..@@@..@@.@@@@@.@@
@@@@.@@@@@@@@@@@@@@@..@.@@@.@.@@@@..@..@@.@.@.@@@@@.@@@@@@@@@@@@@.@@@@@.@.@@@.@.@@@@@@..@..@...@.@@@.@@.@@.@@@..@@@@@.@.@@@@..@@.@@..@@@@@.@
@..@.@.@@..@.@@@@@@@.@.@@@@.@.@@@@@@..@@.@@@@@@@@....@@@@@@@@..@@.@.@@@..@@@@@..@@@@..@@@@@.@@@@....@.@@@@@@.@@@@.@.@.@@@.@@@@@.@.@.@.@@.@.@
@@@..@@@..@@@@@..@@@@@....@@@.@@@@@.@.@..@..@.@@@.@@@.@@@..@@..@@.@@..@@@@....@.@@.@@@.@@@@..@.@@@@@..@..@..@...@@.@@@@.@@@@@@@..@@@@.....@@
@@..@@@@@.@@@.@@@@.@..@.@.@@@@...@@..@@@@.@....@@@.@@.@@@@@@..@.@.@@@@.@@@@..@@....@@@.@@@@@.@@@@@@@@.@.@.@@@@@@.@@.@.@..@@.....@.@.@.@...@@
@.@@@@@@@@@@@@@@@@@.@@@@@@@@@@.@.@.@@@..@@@.@..@@...@.@@@@@..@@@@@@@..@@.@@@.@.@.@.@@.@@@@@.@.@@@@@..@.@@.@...@@@.@@.@.@.@@@@..@@@@@.@..@...
@@@....@@...@.@@@@@@@..@@.@@@.@@@@@@@@..@@@@@.@@@@@.@@@@.@..@.@.@@.@@@@@@@@...@@@.@@@.@.@@..@@@@.@@..@@.@..@.@@..@@@@.@@@.@@@@..@@.@.@@@@.@@
..@.@@@@@@@...@.@@@@...@.@@@..@@...@@.@..@@.@@..@@@@@..@@..@.@@@@@@@..@..@@@@@@@@@@@@@.@.@..@@@@@.@.@@@@@..@...@.@@..@@.@...@..@@.@@@.@@.@@@
.@@@.@@@@.@.@@.@...@.@.@@@..@@@.@@@@@@@@@@..@....@.@@.@@.@@@@.@.@@..@@@@.@@@.@@@@.@@@..@..@@@.@@.@@.@.@.@@@@.@@@..@.@@@@.@.@@@@@.@@.@@.@@@@@
.@@@@.@@@...@@@.@.@..@..@@.@@.@....@@@.@@.@@@@@@@@.@@@@.@@@.@.@@..@.@@@.@@@@@@.@@@@.@@@....@@@.@@@@@.@@@.@@@..@.@@@@@..@@@@@@@@@@@.@@..@.@@@
@@@@@@.@.@@...@.@@.@@@@@.@@.@@..@.@..@.@@@@@@@@.@@@@@@@@@..@.@@@.@.@.@@.@.@@@.@@.@@.@@.@..@..@.@.@@@@@@.@.@@.@@@@.@@....@..@..@..@.@@.@@..@@
@@@..@@@@..@..@..@@@@..@@@..@@...@..@@.@@@@.@@.@..@@@@@@.@.@@@.@@.@@.@@@..@@..@@@.@@.@.@.@@..@@.@@@@@.@.@@@@.@...@@.@@@..@.@@@@.@@..@@.@@@@@
.@..@@@@@@@@..@@..@@..@@@.......@@@@@@....@..@..@@@@.@@@.@@@..@@@@@..@@.@@@..@.@@....@.@@.@.@@.@@@@.@@..@.@.@..@.@.@@.@@@@.@.@@.@@@@.@@@@@@@
@@@@.@@.@.@.@@.@.@..@@..@@@.@@..@@@@@...@.@@..@@.@@@..@@@@..@...@.@.@.@@@.@.@.@.@@..@@.@..@@@..@@@.@@@@@@@..@@@@@..@@@..@@@.@.@...@@.@@@@@@.
@@.@@@@.@@@@.@@@.@@@@@.@@.@@.@@@@@@.@@@.@@..@.@@@.@@@.@..@.@...@@@@@@@..@@@.@@@@@@@@@@.@.@@@.@.@@@@.@@@.@@@.@@@@.@@@.@@@@..@...@@@.@.@@@@@@@
..@@@@.@@@@.@@..@.@@.@@.@@@@@@.@@.@.@@@@.@@@@.@..@...@@@.@@@.@@@@@@..@@@@@@.@@@@.@...@@.@@@.@@..@..@@...@@.@@@@.@@..@...@@...@@@@.@@@@.@@.@@
.@@@@@@@@.@..@@@@@@..@@..@@@@...@.@@..@@.@..@@..@@@.@.@@@.@@.@@@@@.@.@.@@@.@@@@@@@@.@..@@..@@@.@.@@@.@@..@@.@...@..@.@@.@@@.@@.@@@@.@@@@@@@@
.@.@@@.@..@@@@@@@@@@@..@.@.@@@...@@@@.@@@.@.@@@..@@@@@.@.@.@@...@.@@@.@@@.@@@.@@@@@@@@.@.@@@..@@@@@@.@.@@.@@@@@.@@@.@@@@@@@..@.@@@@..@@@@.@@
.@@..@.@@..@@@.@@@.@@@@@..@@@@@@@@...@@@@@@.@@@.@.@@@@@@@.@@.@.@@.@@@@@..@@.@.@@@@@@.@...@@@@@.@@@@@@@@@@@@@@.@@.@..@...@.@@@@.@...@@@@@@@..
.@.@.@@@@@.@@@.@@@..@@@@@@.@@@@@.@@@@@..@.@@..@@@@.@.@.@@...@@@@@@..@@@....@@@@@.@@.@@@@@@@@@.@@@@@.@..@.@@.@.@..@.@@.@@@@@.@.@@@@.@@@@@@@@@
@..@...@@.@.@.@..@@@@....@..@@...@@@.@.@@@@@@@@@@@@.@@.@@@.@@..@@@@@@@@.@@@@@@@@..@.@@@.@.@.@.@.@@@@..@@@@...@...@...@@.@@@..@..@@@@@@.@@@@@
@@@@@@.@.@@.@.@@.....@...@..@@..@@.@@..@@.@@@@@..@.@@@@.@@@@@@..@@@..@@..@@@@@.@@@@@@@..@@..@@@@..@...@..@....@@@..@@@.@@.@@@@.@...@@@..@.@.
@..@@@@.@@@@@@@@..@..@....@@@.@@@..@@@@@@.@...@@@@@@@..@@@@@.@@.@@.@..@@@@...@@@@@@@..@@@@@.@...@@.@@@@@..@..@@@@.@@..@@..@.@...@@.@@.@.@@..
@@@@@@.@...@@@@.@.@.@@@.@..@..@@.@.@@@.@@@@@..@@@@.@@@@.@@@@@...@.@@@@@@@@..@.@@@.@@@.@@@..@@@@@.@@..@@@@@@..@.@@.@.@@@@.@@@@.@..@@@.@@@@@@@
.@@@.@@.@...@.@@@@@@@.@@@.@.@.@.@@..@@@@@@@@.@@@.@@@@@@@@...@@.@.@@@@@@@@@....@.@.@@@@@@..@@@@..@@@@@..@..@@@@.@@@..@@@...@.@.@.@@@@.@.@@@@.
.@@@@@@@@@@@.@@.@@.@@.@@@@@@@@..@@@.@@@@..@.@..@..@@@@@@@..@.@.@@.@@..@@@@@@@.@@.@@@@@@.@.@.@@..@@@...@.@@@.@@.@@@..@.@@@.@@@@@@@@@.@@@..@..
....@.@.@@.@...@@@@..@.@@@@.@@@.@.@.@@@@..@.@.@.@..@@.@@.@@@@@.@@@@@..@@@.@..@@@.@@@@@@@@@@@@.@@@@.@@.@...@@.@@@..@@@.@.@@@@@@@@@@@.@@@.@..@
@...@..@@@..@..@..@.@@.@@..@@@.@....@@@@@@@@.@@..@@.@@.@@@@@.@@@.@.@@@..@..@@...@@@@@@@.@@@@.@...@.@..@@@@.@@@@@.@@..@@@@@@@.@.@.@@@@@@@@.@@
@@..@..@@....@....@@@@@.@@@.@.@.@@@@.@..@@@..@.@@..@@@@@..@@@.@@@.@.@@@.@.@@@@@@@@@@@@@@@@.@@@@.@@@@@.@.@@@@@....@.@@@@..@@..@@@@@@..@.@.@..
@@@@@.@@.@..@..@.@.@@.@@@@@@.@@@@.@@@.@@@@@..@@@.@@@..@@@@@..@.@@@.@@@@@@@.@@@@@@@@@.@.@@.@.@..@@@@@@.@@@.@.@.@.@@@..@@.@.@...@.@.@@..@@@.@@
.@@@@@@@.@.@.@.@@@@@@@@.@@@@@.@@.@@@..@@..@.@...@.@.@@@@@..@.@@.@..@..@..@...@@.@@@.@...@@..@@...@@.@@.@.@@.@@.@@@@@..@@@@@@@..@...@@.@.@..@
.@.@.@@@@@@@@@@@@...@@.@@@@.@@...@.@@...@@...@@.@@.@@.@@@@@@.@.@@@@.@@.@.@@...@@@.@@..@@...@@@@@@@..@.@@....@@@.@@....@@@@@.@@@..@@.@@@@.@@@
@@@...@@@.@.@@@@.@@@.@@.@@@@.@@..@@@@@@@..@@@@@@@@@@.@@..@...@@@...@...@@..@.@@@@@@@@@@.@@@@..@@@..@.@@@.@.@.@@.@.@@.@@@@@@@.@.@@...@@@@...@
@.@.@..@@..@.@@...@@..@@@.@@.@@@.@@.@@@@@.@@.@@@@..@@@@@@...@...@.@@.@..@@.@@@@@@.@..@.@.@@@@@@@@@...@@.@.@@@@.@@..@....@..@@.@@@.@@@@@@@@@.
@@@@.@@.@.@@@@@.@.@@.@@.@@@@@@@@.@..@@.@.@@@@@.@..@@@@@@.@.@@.@...@.@@@@@@@@@@.@@@.@@@@.@@..@@@@.@.@@@@@@@....@.@@@@@@@@..@@@@@.@@@@.@@@.@@@
@.@@@@@@@..@.@.@@.@@@@..@@@@@.@@.@.@@@..@@@@.@@@@@.@@@@@@..@.@@...@.@.@@@@@@@@@@.@@@@.@@@@.@@@.@@@.@@.@.@.@@@@@@@@.@.@@@@@.@@..@@@@...@@@.@@
@...@....@.@@@@@.@.@.@.@@.@@..@@..@..@@@@@.@@.@.@@.@@@.@.@@@.@.@@@@.@.@@.@@@...@@@..@.@@..@.@.@..@@.@@....@@@@..@@.@...@@@@@@@.@@@@@..@@.@@@"
  )
